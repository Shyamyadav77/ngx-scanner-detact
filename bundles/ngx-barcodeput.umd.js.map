{"version":3,"file":"ngx-barcodeput.umd.js","sources":["../../../projects/ngx-barcodeput/src/lib/directive/ngx-barcodeput.directive.ts","../../../projects/ngx-barcodeput/src/lib/ngx-barcodeput.module.ts","../../../projects/ngx-barcodeput/src/public-api.ts","../../../projects/ngx-barcodeput/src/ngx-barcodeput.ts"],"sourcesContent":["import {from, fromEvent, Subject} from 'rxjs';\nimport {debounceTime, distinctUntilChanged, filter, map, mergeMap, takeUntil} from 'rxjs/operators';\nimport {AfterViewInit, Directive, ElementRef, EventEmitter, Input, OnDestroy, Output} from '@angular/core';\n\nexport interface IDetect {\n  type?: string;\n  time?: number;\n  event?: KeyboardEvent;\n  value?: string | number;\n}\n\nexport interface IDelete {\n  type?: string;\n  event?: KeyboardEvent;\n  value?: string | number;\n}\n\n@Directive({\n  selector: '[ngxBarCodePut]',\n})\nexport class NgxBarCodePutDirective implements AfterViewInit, OnDestroy {\n\n  /**\n   * Input delay\n   */\n  @Input() public debounce: number = 0;\n\n  /**\n   * After how many characters start search\n   */\n  @Input() public skipStart: number = 0;\n\n  /**\n   * Data cleansing event\n   */\n  @Output() public onDelete: EventEmitter<IDelete> = new EventEmitter();\n\n  /**\n   * Event after data entry\n   */\n  @Output() public onDetected: EventEmitter<IDetect> = new EventEmitter();\n\n  /**\n   * Use for unsubscribe\n   */\n  private destroy$ = new Subject();\n\n  constructor(private elementRef: ElementRef) {}\n\n  public ngAfterViewInit() {\n\n    /**\n     * Often the code scanner is connected to the computer.\n     * It emulates a press key, so we use keyboard events to press and release keys.\n     */\n    const events = ['keydown', 'keyup'];\n\n    /**\n     * Empty object for delay logic\n     */\n    const pressed = {};\n\n    /**\n     * Look at the\n     * {@Link http://reactivex.io/documentation/operators/from.html}\n     */\n    from(events)\n      .pipe(\n        /**\n         * Look at the\n         * {@Link https://rxjs-dev.firebaseapp.com/api/operators/mergeMap}\n         */\n        mergeMap((event) => fromEvent(this.elementRef.nativeElement, event)),\n\n        /**\n         * Prepare input data\n         */\n        map((event: KeyboardEvent) => {\n          switch (event.type) {\n            case 'keydown':\n\n              /**\n               * Since \"which\" is deprecated, we use it for a temporary variable\n               * and set the processing time keydown.\n               */\n              pressed[event.which] = event.timeStamp;\n              break;\n            case 'keyup':\n\n              /**\n               * In the delay set the difference between keydown and keyup events.\n               */\n              Object.assign(event, {duration: (event.timeStamp - pressed[event.which]) / 1000});\n              break;\n          }\n\n          /**\n           * @return {event: KeyboardEvent}\n           */\n          return event;\n        }),\n        filter((event: KeyboardEvent) => {\n          if (event.keyCode === 8 || event.code === 'Backspace' || event.which === 8) {\n            /**\n             * Used to clear data.\n             */\n            this.onDelete.emit({event, value: (event.target as HTMLInputElement).value, type: 'delete'});\n          }\n\n          /**\n           * Return data after typed in two characters.\n           */\n          return (event.target as HTMLInputElement).value.length > this.skipStart;\n        }),\n\n        /**\n         * Data entry delay is used to limit requests.\n         */\n        debounceTime(this.debounce),\n\n        /**\n         * Look at the\n         * {@Link http://reactivex.io/documentation/operators/distinct.html}\n         */\n        distinctUntilChanged(),\n      )\n\n      /**\n       * Use for unsubscribe\n       */\n      .pipe(takeUntil(this.destroy$))\n\n      /**\n       * Subscribe to the input data and determine the delay time for our purposes.\n       */\n      .subscribe((event: any) => {\n        if (event.duration > 0.02) {\n\n          /**\n           * Keyboard input.\n           */\n          this.onDetected.emit({event, value: event.target.value, time: event.duration, type: 'keyboard'});\n        } else if (event.duration <= 0.02) {\n\n          /**\n           * Input from the scanner.\n           */\n          this.onDetected.emit({event, value: event.target.value, time: event.duration, type: 'scanner'});\n        }\n      });\n  }\n\n  /**\n   * Use for unsubscribe\n   */\n  public ngOnDestroy() {\n    this.destroy$.next(true);\n    this.destroy$.complete();\n  }\n}\n","import {NgModule} from '@angular/core';\nimport {NgxBarCodePutDirective} from './directive/ngx-barcodeput.directive';\n\n@NgModule({\n  declarations: [NgxBarCodePutDirective],\n  exports: [NgxBarCodePutDirective],\n})\nexport class NgxBarCodePutModule {}\n","/*\n * Public API Surface of ngx-barcodeput\n */\n\nexport * from './lib/directive/ngx-barcodeput.directive';\nexport * from './lib/ngx-barcodeput.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["EventEmitter","Subject","from","mergeMap","fromEvent","map","filter","debounceTime","distinctUntilChanged","takeUntil","Directive","ElementRef","Input","Output","NgModule"],"mappings":"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"}